---
import logo from "../images/base-logo.png?w=450&format=avif;webp;&picture";

import { longTitle, metaDescription, socialImageLink } from "../lib/constants";

type Props = {
  title: string;
};

const { title } = Astro.props;

const links: Array<{ label: string; href: string }> = [
  { label: "Home", href: "/" },
  { label: "Upcoming runs", href: "/run" },
  { label: "Info & contact", href: "/info" },
];

const jsonLdData = {
  "@context": "http://www.schema.org",
  "@type": "SportsTeam",
  name: longTitle,
  logo: socialImageLink,
  description: metaDescription,
  address: {
    "@type": "PostalAddress",
    addressLocality: "Maroochydore ",
    addressRegion: "QLD",
    postalCode: "4558",
    addressCountry: "Australia",
  },
  geo: {
    "@type": "GeoCoordinates",
    latitude: "-26.65",
    longitude: "153.10",
  },
};

const avifSrcset = logo.sources.avif.map((i) => i.src).join(", ");
const webpSrcset = logo.sources.webp.map((i) => i.src).join(", ");
---

<html lang="en">
  <head>
    <meta charset="utf-8" />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />

    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />

    <title>{title}</title>
    <meta name="description" content={metaDescription} />

    <meta property="og:title" content={title} />
    <meta property="og:site_name" content={longTitle} />
    <meta property="og:description" content={metaDescription} />
    <meta property="og:type" content="website" />
    <meta property="og:image" content={socialImageLink} />
  </head>

  <body class="bg-gray-50 dark:bg-gray-950">
    <div class="prose dark:prose-invert mx-auto p-4 sm:my-12">
      <header
        class="flex flex-col sm:flex-row sm:justify-between sm:items-center"
      >
        <div>
          <picture>
            <source type="image/avif" srcset={avifSrcset} />
            <source type="image/webp" srcset={webpSrcset} />
            <img
              src={logo.fallback.src}
              width={(logo.fallback.w * 2) / 3}
              height={(logo.fallback.h * 2) / 3}
              class="mt-0 mb-2"
              alt="QPRC logo"
            />
          </picture>
          <h1 class="text-base my-0 font-normal">{longTitle}</h1>
        </div>
        <nav>
          <ul class="flex sm:block list-none gap-2 pl-0">
            {
              links.map((link) => (
                <li>
                  <a
                    href={link.href}
                    class:list={{
                      "no-underline": link.href !== Astro.url.pathname,
                    }}
                  >
                    {link.label}
                  </a>
                </li>
              ))
            }
          </ul>
        </nav>
      </header>

      <hr class="mt-0 -mb-6 sm:mt-10 sm:-mb-2" />

      <main>
        <section>
          <slot />
        </section>
      </main>

      <hr class="mt-10 mb-10" />

      <footer>
        <p>
          Open this link <a href="webcal://www.qprc.com.au/cal.ics"
            >https://www.qprc.com.au/cal.ics</a
          > to subscribe to new events!
        </p>
      </footer>
    </div>
  </body>

  <script type="application/ld+json" set:html={JSON.stringify(jsonLdData)}
  ></script>
</html>

<style is:global>
  a {
    color: theme(colors.orange.700) !important;
    @apply transition-colors;
  }

  a:hover {
    color: theme(colors.orange.800) !important;
    @apply underline;
  }

  @media (prefers-color-scheme: dark) {
    a {
      color: theme(colors.orange.500) !important;
    }

    a:hover {
      color: theme(colors.orange.600) !important;
    }
  }
</style>
